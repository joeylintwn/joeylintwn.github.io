<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>下載PDF</title>
    <script src="scripts/jquery-3.5.1.min.js"></script>
</head>

<body>
    <button type="button" id="ccc">我是按鈕</button>
    <textarea id="sss">

    </textarea>
 
 


    <script type="text/javascript">
        var urlar = [

        ]

        document.getElementById('ccc').addEventListener("click",function(){
            alert(123);
        });
         
        var loadcnt = 0;
        var vw = window.open("https://wra.e-land.gov.tw/HDST/WaterAdmin/Check/CheckA?checkID=28831", "_blank", ""); //第二种写法，不用再每个页面添加window.focus(); 只需改为这种写法
        vw.document.title = loadcnt;
        console.log('loadstart' + Date.now().toString());
        vw.addEventListener('load', function () {
            alert('loadcomplete');
            console.log('loadcomplete');
            vw.btnExportODF_onclick('pdf')
        }, true);


        vw.onload = function () {
            alert('loadcomplete1');
            console.log('loadcomplete1');
            vw.btnExportODF_onclick('pdf');
        };

        /*
         $(document).ready(function (e) {
           
             

             /*
            var iframe = document.getElementById("box");
            if (iframe.attachEvent) {
                iframe.attachEvent("onload", function () {
                    alert('onload')
                    //iframe載入完成後你需要進行的操作
                });
            } else {
                iframe.onload = function () {
                    //iframe載入完成後你需要進行的操作
                    console.log('讀取到第' + loadcnt + '筆');
                    var $iframe = $(this),
			        $contents = $iframe.contents();
                    $iframe.get(0).contentWindow.btnExportODF_onclick('pdf');
                   
                    var data = $iframe.contents().find("#div_form").html();
                    console.log(data);
                    var blob = new Blob([data], { "type": "text/html" });
                    console.log(blob);

                    //對於Blob物件，我們可以創建出一個URL來訪問它。使用URL物件的createObjectURL方法。
                    var a = document.createElement('a');
                    a.download = urlar[loadcnt][0]+'.html';
                    a.href = window.URL.createObjectURL(blob);
                    a.click()

                    loadcnt += 1;
                    if (loadcnt == urlar.length) {
                        alert('done');
                        return;
                    } else {
                        console.log('開始下載pdf，3秒後開啟下一筆')
                        setTimeout(function () {
                            $('#box').attr('src', urlar[loadcnt][1]);
                        }, 3000);
                    }
                };
            }
        });
        
        $('#box').attr('src', urlar[loadcnt][1]);
        */
        //if...else...是一種相容ie的寫法

      
    </script>
    
</body>
</html>
