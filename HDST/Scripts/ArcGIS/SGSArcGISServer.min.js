dojo.declare("SGSTileLayer",esri.layers.TiledMapServiceLayer,{constructor:function(n,t,i,r){this._url=n;this._resource=null;this._layer=i;this.isProxy=r;var u=this,f=n+"/GetCacheConfig?FORMAT=JSON";$.getScript(f,function(){var n=result.Infomation,i,r,o,s;if(n){this._resource=n.ResourceName;var h=parseInt(n.TileWidth),c=parseInt(n.TileHeight),l=parseFloat(n.CornerLeft),a=parseFloat(n.CornerLower),f=n.Envelope,v=parseFloat(f.Left),y=parseFloat(f.Top),p=parseFloat(f.Right),w=parseFloat(f.Bottom);u.spatialReference=new esri.SpatialReference({wkid:3857});u.initialExtent=u.fullExtent=new esri.geometry.Extent(v,w,p,y,u.spatialReference);var e=[],b=n.Scales,t=b.Scale;if(console.log(t),t&&t.length>0)for(i=0;i<t.length;i++)r=t[i],o=r.Denominator?parseFloat(r.Denominator):parseFloat(r._text),s=parseFloat(r.Factor),e.push({level:i,scale:o,resolution:s});u.tileInfo=new esri.layers.TileInfo({dpi:"96",format:"image/png",compressionQuality:0,spatialReference:{wkid:"3857"},rows:h,cols:c,origin:{x:l,y:a},lods:e});u.loaded=!0;u.onLoad(u)}})},getTileUrl:function(n,t,i){var r=this.tileInfo.lods.length;return this.isProxy==!0?"./ArcGIS/tgosProxy.ashx?"+this._url+"/GetCacheImage?S="+n+"&X="+i+"&Y="+(-t-1)+"&L="+this._layer:this._url+"/GetCacheImage?APPID=iXU5l27hitiQ/5Hkzu49scMBuI5TxTUtrQGnFhW23ENR1vlEjx97bA==&APIKEY=cGEErDNy5yN/1fQ0vyTOZrghjE+jIU6ubRcZ1A1O+zxNBo1roTNLf5Dq9bzq3jhRaiq+4HW4+iFBHA9xfkySHXqeZaZqH6cF74wq93rto/WnzzlRynBJvkDefRcgiG+4H/PSUj8ysRF7MDW5xEYcHTNFVuEdz27f+d7TF8jvTyItgFVjlYWF3RONkJH5OntOyZWXu5vhgnTSSe/sAyLF1NS1h+rV+RWWHyQsVpVBawir87QGF0iLGR3MegBqTJfaH9DO6yM+oRl7El5cpH3vvsPwKF9TrwPnK0foNZw3+Wk/TFMgiAu/3PcAkZ/OJWX71/J77XV+xDIc+8cNBfVBwyTjqxWs/TV7xgsep7TiRZTc9WpY+nixp7aEh9MFTw/dbw+L1dMeTBz933Ll5XNRVBOYNSLR+tUm&S="+n+"&X="+i+"&Y="+(-t-1)+"&L="+this._layer}});