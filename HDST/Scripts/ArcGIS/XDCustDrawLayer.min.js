function XDCustDrawLayer(n,t){var r=n,u=r.getGraphicsLayer(t);this.baseLayer=u;this.clearPaths=function(){u.clear()};this.addMarker=function(n,t,f,e){var l=new esri.symbol.PictureMarkerSymbol(t,20,20),o=new esri.Graphic(n,l),h,c,s;return o.id=f,u.add(o),e!=undefined&&(h=new esri.symbol.Font,h.setSize(18),h.setWeight(esri.symbols.Font.WEIGHT_BOLD),c=new Point(o.geometry.x,o.geometry.y,r.spatialReference),s=new esri.symbol.TextSymbol,s.setText(symtext[i]),s.setColor(new Color([0,0,0])),s.setFont(h),s.setKerning(!0),s.setOffset(0,-6),o=new esri.Graphic(c,s),o.id="t"+i,r.graphics.add(o)),o};this.toWKT=function(n){switch(n.type){case"point":return PointToWKT(n);case"polygon":return PolygonToWKT(n);case"polyline":return LineToWKT(n);case Default:alert("不支援")}};this.DrawPolygon=function(n,t){return alert("將取消該功能 改由 CreatePolygon 取代"),this.CreatePolygon(n,t)};XDCustDrawLayer.prototype.getFeatureFromWKT=function(){var n;return wkt.toUpperCase().indexOf("POLYGON")>=0?n=WktToPolygon(wkt,r.spatialReference):wkt.toUpperCase().indexOf("POLYLINE")>=0?n=WktToPolyline(wkt,r.spatialReference):wkt.toUpperCase().indexOf("POINT")>=0&&(n=WktToPolyline(wkt,r.spatialReference)),n};XDCustDrawLayer.prototype.DrawGeoFromWKT=function(n,t,i,r){var u=this.getFeatureFromWKT(n);switch(u.type){case"point":this.addMarker(u);break;case"polygon":this.CreatePolygon(u,r);break;case"polyline":this.CreatePolyLine(u,r);break;case Default:alert("不支援")}return u};XDCustDrawLayer.prototype.DrawGeoFromWKTs=function(n,t,r,u){var s=new ol.format.WKT,f=[],e=n.split(";"),o;for(i=0;i<e.length;i++)o=this.DrawGeoFromWKT(e[i],t,r,u),f.push(o);return f};XDCustDrawLayer.prototype.getBoundsFromFeatures=function(n){var t,r;for(i in n)r=n[i],t=t==null?r.getGeometry().getExtent():t.Union(r.getGeometry().getExtent());return t};XDCustDrawLayer.prototype.CreateText=function(n,t,i){i=new ol.style.Style({text:new ol.style.Text({textAlign:"Start",textBaseline:"Middle",font:"Normal 20px Arial",text:t,fill:new ol.style.Fill({color:"#ffa500"}),offsetX:0,offsetY:0,rotation:0})});var u=new ol.geom.Point(n),r=new ol.Feature(u);return r.setStyle(i),this.source.addFeature(r),r};XDCustDrawLayer.prototype.CreateCircle=function(n,t){t==null&&(t=new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 100, 50, 0.3)"}),stroke:new ol.style.Stroke({width:2,color:"rgba(255, 100, 50, 0.8)"}),image:new ol.style.Circle({fill:new ol.style.Fill({color:"rgba(55, 200, 150, 0.5)"}),stroke:new ol.style.Stroke({width:1,color:"rgba(55, 200, 150, 0.8)"}),radius:7})}));var i=new ol.geom.Circle(n,500),r=new ol.Feature(i);return this.source.addFeature(r),i};XDCustDrawLayer.prototype.CreateMultiPolygon=function(n,t){var r,u;t.bounds=new google.maps.LatLngBounds;r=[];for(i in n)try{if(n[i].length>0){for(u=new google.maps.Polygon(this.geodesicOptions),u.setMap(this.map.basemap),u.setPath(n[i]),k=0;k<n[i].length;k++)t.bounds.extend(n[i][k]);r.push(u)}}catch(f){alert(f.toString())}return this.Geometrys[t.Shapeindex]=r,r};XDCustDrawLayer.prototype.CreatePolygon=function(n){var i=new esri.symbol.SimpleFillSymbol(esri.symbol.SimpleFillSymbol.STYLE_SOLID,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new esri.Color([255,52,250]),3),new esri.Color([255,52,250,.25])),t=new esri.Graphic(n,i);return u.add(t),t};XDCustDrawLayer.prototype.CreatePolyline2=function(n,t){var f,i,r;return t=t==undefined?{color:[255,0,0,255],width:4,type:"esriSLS",style:"esriSLSSolid"}:{color:[0,255,255],width:4,type:"esriSLS",style:"esriSLSDash"},f={geometry:n,symbol:t},i=new esri.Graphic(f),r=new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_DASH,new esri.Color([0,255,255]),3),r.setMarker({style:"arrow",placement:"end"}),i.symbol=r,u.add(i),i};XDCustDrawLayer.prototype.CreatePolyLine=function(n,t){var f,i,r;return t=t==undefined?{color:[255,0,0,255],width:4,type:"esriSLS",style:"esriSLSSolid"}:{color:[0,255,255],width:4,type:"esriSLS",style:"esriSLSDash"},f={geometry:n,symbol:t},i=new esri.Graphic(f),r=new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_DASH,new esri.Color([0,255,255]),3),r.setMarker({style:"arrow",placement:"start"}),i.symbol=r,u.add(i),i};XDCustDrawLayer.prototype.DrawFeature=function(n){var u,f,t;if(n.GeoType==1)r.CustDrawLayer.addMarker(n.GeoData.getGeometry(),"../GMap/pin.png",n.Shapeindex,"",!1);else if(n.GeoType==2)r.CustDrawLayer.CreatePolyLine(n.GeoData,{});else if(n.GeoType==3)if(n.GeoData.isMulti){for(i in n.GeoData)f=n.GeoData[i],i==0?(t=r.CustDrawLayer.DrawPolygon(f,ovOptions.polygonOptionsc),u=t.bounds):u.extend(t);r.fitBounds(u)}else t=r.CustDrawLayer.DrawPolygon(n.GeoData,ovOptions.polygonOptions)}}